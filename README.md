Zone-Based Draw Distance for MTA<br />
by FlashGun
-

**About**<br />
Zone-Based Draw Distance Optimizer (ZBDD) is a resource designed for Multi Theft Auto San Andreas that optimizes the rendering distances of objects within predefined zones. ZBDD enhances the visibility of objects in specific areas of your map by extending their draw distances, ensuring they remain visible over greater distances. 

**Components**
- **ZBDD_server:** This tool is used on the server to define and manage enhacement zones (colshapes). These colshapes define the zones within which object rendering distances are optimized.<br />
- **ZBDD_map:** This resource is included in your map and applies the preconfigured enhancements from ZBDD_server to optimize object visibility based on the defined zones.

<details>
  <summary>Video demonstration </summary>
https://youtu.be/1dBbDOSC6Kg?si=ILAp5dgJkFie70M6
  
</details>

ZBDD_server: Defining Colshapes
-
This tool will help you create cuboid or spherical colshapes and adjust their size, position, and type using simple key controls. It provides real-time visual feedback on the clshapes and the objects they contain using colors: green objects are those that can be processed by ZBDD_map (when the coordinates for the shape capturing them are passed), while red objects indicate that they are within two or more shapes simultaneously, which should be avoided to maintain optimal performance.

**Controls**
```
H + Left Click: Create a shape.
Q: Switch between cuboid and sphere shapes.
Arrow Keys: Move the shape horizontally.
Page Up / Page Down: Move the shape vertically.
Numpad '4', '6', '8', '2': Resize cuboid width and depth.
Numpad '9', '3': Resize cuboid height.
Numpad '+' / '-': Resize shapes (both types).
LCTRL / LALT: Speed up or slow down resizing/moving operations.
/savecol: Save the current shape configuration - will output the coordinates which you will copy into ZBDD_config.json of ZBDD_map.
/togglecol: Toggle colShape preview.
```
ZBDD_map: Optimizing Rendering Distance
-

This is the main brain behind enhancing the draw distance of objects within predefined zones. The code is fully compatible with standard MTA Race servers and current MGM servers, and it works with any server-specific draw distance features without causing conflicts. By processing everything at the start, it minimizes any performance impact during gameplay. Once set up, there is nothing running anymore, reducing the risk of any performance issues while players are driving.

**Configuration (ZBDD_config.json)**

*This is the only file from ZBDD_map you should edit according to your map's needs. Here is the breakdown of each key:*

`debugMode:` Toggles detailed logging and debugging information. Set to true for debugging.<br />
`batchSize:` Specifies the number of objects to process in each batch. Edit carefully!<br />
`batchInterval:` Sets the time interval (in milliseconds) between processing batches. Edit carefully!<br />
`trackObjects:` Lists the IDs of objects that should be rendered as highLODs to avoid collision issues.<br />
`globalExclude:` Specifies the IDs of objects that should never be enhanced<br />
`shapes:` Defines the zones where optimizations are applied. Coordinates for this are generated by ZBDD_server. Within each shape:
- `type:` Specifies the shape type, either cuboid or sphere.<br />
- `x, y, z:` Coordinates for the center of the shape.<br />
- `width, depth, height:` Dimensions for cuboid shapes.<br />
- `radius:` Radius for spherical shapes.<br />
- `exclude:` Lists object IDs that should not be enhanced within this specific shape.

**IMPORTANT:** Listing your track objects under `trackObjects` is important in case any of the objects that make up your track(surfaces players should be drive on) have been grabbed by ZBDD(you will notice that when defining your shapes with ZBDD_server). In case no track objects were captured by ZBDD_server you can skip this step.

How to Use
-

**1. Configure and Integrate ZBDD_map**<br />
Copy the ZBDD_main folder from ZBDD_map into the directory of your map resource. Edit meta.xml inside your map resource so it includes these two:<br />
`<script src="ZBDD_main/ZBDD_main.luac" type="client" />`<br />
`<file src="ZBDD_main/ZBDD_config.json" type="client" />`

**2. Copy and start ZBDD_server Resource**<br />
Copy ZBDD_server to your resources directory of your server then start it.

**3. Create and Modify Colshapes**<br />
Use H + Left Click to create a new colshape (zone). Switch between cuboid and spherical shapes as you wish and resize/move the shape to accomodate your needs.

**4. Save Coordinates**<br />
Once your shapes are set up, use the /savecol command to save the coordinates for your current shape. It will output them in the chat - copy them.

**5. Edit ZBDD_config.json**<br />
Open the ZBDD_main/ZBDD_config.json file. Paste the coordinates and details of the colshapes generated by ZBDD_server into the shapes section of this file. Adjust any other settings like globally/locally excluded objects, track objects, debug mode, processing intervals etc. as necessary to match your requirements. Make sure to read the info above regarding ZBDD_map.

**6. Start your map and check the results**

For any suggestions/issues contact me on Discord: `flashgun`.
-
